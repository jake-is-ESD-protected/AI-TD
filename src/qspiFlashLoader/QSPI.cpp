#include "daisy_seed.h"

using namespace daisy;

DaisySeed hw;

#define IN_SHAPE 13

#define SHAPE_L_1 64
#define SHAPE_L_2 32
#define SHAPE_L_3 16
#define SHAPE_L_4 8
#define SHAPE_L_5 4
#define SHAPE_L_6 2

// clang-format off
const float weights_l1[SHAPE_L_1][IN_SHAPE]{
        {0.10075493156909943, 0.3566121459007263, 0.35607925057411194, 0.08709380775690079, 0.2170993983745575, -0.08201193809509277, -0.1741194725036621, 0.38416150212287903, -0.20034457743167877, 0.21927590668201447, -0.1141672432422638, 0.05771370604634285, -0.29104575514793396},
        {0.24916118383407593, 0.08565279841423035, 0.14077401161193848, -0.12863223254680634, 0.2259400486946106, -0.18976472318172455, -0.1417447328567505, 0.18547208607196808, -0.09313152730464935, 0.023837922140955925, -0.017866691574454308, 0.2519184947013855, -0.23705878853797913},
        {0.16126768290996552, -0.22596727311611176, -0.149835467338562, -0.10864199697971344, -0.22342588007450104, 0.03531395271420479, 0.1609470248222351, 0.18195724487304688, -0.1067662164568901, 0.250584214925766, 0.34821629524230957, 0.3159988820552826, -0.336956262588501},
        {0.18495967984199524, -0.12482716888189316, 0.16126440465450287, -0.10466267913579941, 0.30419692397117615, -0.25574636459350586, 0.18712472915649414, -0.16750113666057587, -0.29954764246940613, -0.12126456946134567, 0.07396946847438812, -0.2230500429868698, 0.013400652445852757},
        {-0.18246178328990936, -0.08709359169006348, 0.02968868985772133, -0.32737070322036743, -0.19422349333763123, 0.11981424689292908, 0.1480657011270523, 0.22301535308361053, -0.17803236842155457, 0.014099892228841782, -0.21602027118206024, 0.28824642300605774, 0.23759759962558746},
        {-0.09058330953121185, 0.04836568236351013, 0.24450504779815674, -0.1860712468624115, 0.2459801435470581, 0.3316989243030548, -0.014336925931274891, 0.07742617279291153, 0.16783979535102844, 0.22363218665122986, -0.011347370222210884, -0.11148647964000702, 0.3197847902774811},
        {0.1580025851726532, -0.2037685066461563, 0.2061389535665512, 0.22420679032802582, 0.15249116718769073, 0.2663359045982361, 0.15881182253360748, 0.2363402545452118, 0.16213767230510712, -0.08507372438907623, 0.036010149866342545, 0.22526352107524872, -0.1894763857126236},
        {0.03608667477965355, 0.108736053109169, 0.18128857016563416, -0.21058443188667297, -0.07717892527580261, 0.31086793541908264, -0.21314530074596405, -0.1674513965845108, -0.03345472738146782, -0.10554596781730652, 0.14846716821193695, -0.00760769983753562, 0.22425828874111176},
        {-0.21398741006851196, -0.2114025354385376, -0.16865500807762146, -0.048610687255859375, 0.05225569009780884, 0.1822255253791809, -0.11079466342926025, -0.14822284877300262, 0.11609792709350586, -0.2557198703289032, -0.16256478428840637, -0.25289568305015564, -0.12379515171051025},
        {-0.02113405242562294, -0.07785462588071823, -0.009579798206686974, 0.006417135242372751, 0.025812558829784393, -0.17360995709896088, -0.03223463147878647, -0.3453989624977112, 0.16115711629390717, 0.22221225500106812, -0.021315842866897583, 0.2152165323495865, 0.3115367889404297},
        {-0.002482702722772956, 0.08317015320062637, -0.3150544762611389, 0.015300191938877106, -0.23766550421714783, 0.12952446937561035, 0.20830896496772766, 0.03883061185479164, -0.025873733684420586, -0.08524810522794724, 0.12001578509807587, 0.030214732512831688, 0.21678179502487183},
        {0.14962787926197052, 0.1446983963251114, 0.039177924394607544, 0.24537764489650726, 0.21733592450618744, -0.03579346463084221, 0.12333006411790848, -0.07854694128036499, 0.28166428208351135, -0.12110011279582977, 0.15519648790359497, 0.1359253227710724, 0.2175081968307495},
        {0.2648800015449524, -0.44004392623901367, -0.0019105433020740747, -0.19703467190265656, 0.337047815322876, -0.16625748574733734, 0.12519852817058563, -0.025401776656508446, 0.005511655006557703, -0.1552736610174179, -0.01984478533267975, 0.1568950116634369, -0.34050026535987854},
        {0.23872226476669312, -0.3478967547416687, 0.13542120158672333, 0.023321939632296562, -0.1962420493364334, -0.025553636252880096, 0.03345298394560814, 0.01854919083416462, 0.26335740089416504, -0.21999084949493408, 0.14322593808174133, -0.14734219014644623, 0.38383373618125916},
        {0.12874111533164978, -0.25563377141952515, 0.17079418897628784, -0.2762812376022339, -0.25849658250808716, -0.3695163130760193, 0.0638284832239151, 0.24377179145812988, -0.02878052368760109, 0.12228937447071075, 0.13480530679225922, 0.2511884570121765, 0.09824461489915848},
        {0.14260458946228027, 0.019743459299206734, -0.0523122176527977, 0.25874337553977966, -0.26291921734809875, 0.11099947988986969, 0.0638388991355896, 0.10253126919269562, -0.3206762373447418, 0.22567947208881378, 0.052326615899801254, 0.11113537847995758, -0.4838109016418457},
        {0.002869588788598776, 0.04918360710144043, 0.10376416891813278, 0.07910876721143723, -0.19219300150871277, -0.15645599365234375, -0.011460734531283379, 0.14610031247138977, -0.13847209513187408, -0.11699879169464111, -0.10636923462152481, 0.13230445981025696, 0.3046351969242096},
        {0.10001204907894135, -0.13468311727046967, -0.11173120141029358, -0.2683543562889099, -0.19478492438793182, -0.17583739757537842, 0.13322153687477112, 0.03597636893391609, -0.26903966069221497, -0.23576553165912628, 0.07716986536979675, 0.10191021859645844, -0.1435350477695465},
        {0.04683181270956993, 0.1844048947095871, -0.19058987498283386, 0.1194201335310936, 0.2714725136756897, 0.23230662941932678, -0.2875097393989563, -0.27425625920295715, -0.1563020497560501, -0.011178038083016872, 0.2567845284938812, -0.23086923360824585, -0.10991781949996948},
        {-0.13742101192474365, -0.13551314175128937, 0.11240753531455994, -0.10339237004518509, 0.04096515476703644, 0.24143056571483612, 0.32570740580558777, 0.12194205075502396, 0.016971828415989876, 0.3062535226345062, 0.16640590131282806, 0.22136694192886353, 0.08361359685659409},
        {0.019335491582751274, -0.025399276986718178, 0.2745148241519928, 0.25637757778167725, -0.07882902026176453, -0.1948811560869217, 0.25767239928245544, 0.28306517004966736, 0.12709839642047882, 0.008028274402022362, 0.050870634615421295, -0.2685798108577728, 0.38155582547187805},
        {0.14662837982177734, -0.2948108911514282, -0.14060883224010468, 0.07329986989498138, -0.06900028139352798, 0.07717327028512955, 0.18785294890403748, -0.39438170194625854, 0.2914663255214691, -0.28973689675331116, -0.22488833963871002, -0.11838726699352264, 0.37364426255226135},
        {0.21089816093444824, -0.185502827167511, 0.28317564725875854, -0.07066687196493149, 0.04643065482378006, -0.010784365236759186, 0.010469230823218822, 0.10827545821666718, -0.34807804226875305, -0.20173829793930054, -0.27301260828971863, 0.0846426710486412, -0.23144444823265076},
        {0.038039714097976685, 0.03745777904987335, 0.27643153071403503, 0.26641595363616943, 0.39844244718551636, -0.026194242760539055, -0.14523674547672272, -0.12724633514881134, 0.12677812576293945, 0.08089853823184967, 0.13345955312252045, -0.004585720598697662, -0.2810293436050415},
        {-0.15572449564933777, 0.10106834769248962, -0.07629618048667908, -0.18236495554447174, -0.13290125131607056, 0.00970807671546936, -0.10567411780357361, -0.08573198318481445, -0.10052654147148132, -0.21833688020706177, -0.05570608377456665, -0.09702271223068237, -0.24659419059753418},
        {-0.3397482633590698, -0.2623347342014313, -0.17738623917102814, 0.24555550515651703, 0.012214619666337967, -0.11466797441244125, 0.133608877658844, 0.030290700495243073, -0.10275430232286453, 0.06772270798683167, 0.034357961267232895, 0.19773735105991364, 0.020771948620676994},
        {0.06635939329862595, -0.1767493635416031, 0.1523735076189041, -0.11147341132164001, -0.0480542853474617, 0.09275932610034943, -0.0644381046295166, 0.15756037831306458, 0.21782170236110687, -0.11139893531799316, 0.13103219866752625, 0.11161540448665619, -0.09131155908107758},
        {-0.12366070598363876, -0.1851162612438202, -0.32517915964126587, 0.07085084170103073, 0.11505954712629318, 0.4179171621799469, -0.2531581223011017, -0.18948794901371002, -0.33155810832977295, 0.028705628588795662, -0.058404792100191116, -0.01785709336400032, 0.19856859743595123},
        {-0.0909537747502327, 0.04818026348948479, 0.305623859167099, -0.051323018968105316, -0.22852182388305664, 0.06105497106909752, 0.06604897230863571, -0.1249886155128479, -0.10833977907896042, -0.031379394233226776, 0.00297068664804101, 0.2444787174463272, -0.25140705704689026},
        {-0.06983141601085663, 0.1720450222492218, 0.12989768385887146, -0.0739750936627388, -0.24702616035938263, -0.12236596643924713, 0.07839320600032806, -0.2535724937915802, -0.21265120804309845, 0.02588558942079544, 0.2746047079563141, -0.11937759816646576, -0.0554567389190197},
        {0.09292303770780563, -0.25805315375328064, -0.11454492807388306, 0.16767917573451996, -0.11604765802621841, -0.1520593911409378, 0.27878740429878235, -0.2911151051521301, 0.132923424243927, -0.2556588649749756, 0.13233689963817596, 0.2777509093284607, 0.16149286925792694},
        {-0.20328310132026672, -0.12286373227834702, -0.09783114492893219, -0.12249434739351273, -0.29052668809890747, -0.0250223558396101, 0.316193163394928, 0.03191598504781723, -0.051688890904188156, -0.18126462399959564, 0.2710539996623993, 0.38228803873062134, 0.14930686354637146},
        {0.09032750874757767, 0.16131684184074402, 0.2783651053905487, -0.0065130251459777355, 0.0881122276186943, 0.2698136270046234, 0.019337419420480728, -0.01902027800679207, 0.07998863607645035, 0.016934573650360107, 0.07185851037502289, 0.19996260106563568, 0.13597732782363892},
        {-0.20379729568958282, -0.1657235324382782, 0.07724282145500183, 0.12472958117723465, -0.18164831399917603, -0.2316189557313919, 0.08712894469499588, -0.23414617776870728, -0.23135891556739807, 0.020360400900244713, 0.03849745914340019, -0.13824042677879333, -0.04325486347079277},
        {0.20028822124004364, -0.582040011882782, 0.046664535999298096, -0.3463674485683441, 0.16980226337909698, 0.06884771585464478, -0.31806710362434387, 0.06806571781635284, 0.2697078287601471, -0.042017608880996704, 0.17491981387138367, -0.022169973701238632, 0.2728163003921509},
        {0.12238380312919617, 0.14941097795963287, 0.27543962001800537, 0.031832076609134674, 0.11847619712352753, 0.1979253739118576, -0.10018759965896606, -0.06473353505134583, -0.07800888270139694, 0.037416327744722366, 0.120899498462677, -0.024861831218004227, -0.5053554177284241},
        {0.0843476876616478, -0.3271031677722931, 0.3185502588748932, -0.07279723137617111, 0.3535642921924591, -0.21556557714939117, 0.2988961338996887, -0.13461583852767944, 0.338998019695282, 0.13503356277942657, 0.09726665169000626, 0.11715561896562576, 0.21257002651691437},
        {0.3275744318962097, 0.12783142924308777, 0.41281551122665405, -0.13360853493213654, 0.1163962185382843, -0.017301468178629875, 0.1532198190689087, 0.25492483377456665, 0.3973175585269928, 0.1879778504371643, 0.29589563608169556, -0.1050482913851738, -0.17090220749378204},
        {0.04832449555397034, 0.08730804175138474, 0.19013254344463348, 0.2641236186027527, 0.3366120159626007, 0.2972874045372009, 0.13895495235919952, 0.12623320519924164, 0.26403528451919556, 0.005299003329128027, -0.1563541293144226, 0.2958258092403412, -0.04778636619448662},
        {0.2820987105369568, -0.421120285987854, 0.19312241673469543, -0.03934409096837044, -0.1452171802520752, -0.13341616094112396, -0.08508062362670898, -0.23497998714447021, 0.16894906759262085, 0.19086818397045135, 0.1710214912891388, 0.28949886560440063, -0.37779074907302856},
        {0.24334591627120972, -0.2354310005903244, 0.26811736822128296, 0.07456605136394501, 0.2827397286891937, 0.09344402700662613, -0.19306932389736176, 0.20714853703975677, 0.024947844445705414, -0.027573173865675926, 0.2398916333913803, -0.2635175287723541, -0.09573569148778915},
        {-0.13026349246501923, 0.17179521918296814, -0.10768070816993713, 0.057982731610536575, 0.13933530449867249, 0.11897152662277222, 0.03422006592154503, -0.1198631003499031, -0.06989052146673203, -0.18776769936084747, -0.25739920139312744, 0.2905348241329193, 0.2201727032661438},
        {-0.1374376267194748, -0.07005038857460022, 0.3169874846935272, 0.248546302318573, 0.09397818148136139, 0.14329391717910767, -0.06021451950073242, -0.04432941600680351, 0.11321306973695755, 0.029208725318312645, 0.22283083200454712, 0.3915944993495941, -0.39471757411956787},
        {0.21427634358406067, 0.14595061540603638, 0.41101089119911194, 0.0831112414598465, 0.16354012489318848, -0.12032271921634674, -0.10630887746810913, 0.3109434247016907, 0.30834513902664185, 0.04082261025905609, 0.13557110726833344, -0.07752080261707306, -0.1521376073360443},
        {-0.17325764894485474, -0.08571527898311615, 0.20697227120399475, -0.23684018850326538, -0.13226746022701263, 0.0123138427734375, -0.1205371618270874, -0.051885440945625305, -0.14659881591796875, -0.019828468561172485, -0.2426666021347046, -0.02247077226638794, -0.19752448797225952},
        {0.2987837493419647, -0.09411073476076126, -0.0959191620349884, -0.21866895258426666, 0.1478787511587143, 0.2187214493751526, 0.14579643309116364, -0.2547733783721924, 0.286770761013031, -0.06034958362579346, -0.05473916232585907, 0.2619153559207916, 0.017363522201776505},
        {0.018086262047290802, -0.22074927389621735, -0.5095627903938293, -0.0730864480137825, -0.10623668879270554, -0.11691779643297195, 0.09958988428115845, -0.48131462931632996, 0.04509846866130829, -0.17277739942073822, -0.08022152632474899, 0.1511468142271042, 0.31141138076782227},
        {0.27133050560951233, -0.2047693431377411, -0.1299479454755783, 0.001293607521802187, 0.16669917106628418, 0.28147658705711365, 0.13944628834724426, 0.30789265036582947, 0.034173816442489624, -0.08015190064907074, 0.131544291973114, -0.23268279433250427, -0.026062889024615288},
        {0.22089779376983643, 0.041378505527973175, 0.15331333875656128, 0.088184654712677, -0.06237892434000969, -0.07253418117761612, 0.22954589128494263, 0.2818285822868347, 0.31034547090530396, 0.07207632809877396, 0.0981515496969223, -0.1682860106229782, 0.10144864022731781},
        {-0.050051961094141006, -0.030266176909208298, -0.1551893800497055, 0.33565571904182434, -0.14633886516094208, -0.14580121636390686, -0.07712918519973755, -0.07887155562639236, -0.03704453259706497, -0.1320062279701233, 0.09240341931581497, -0.020910387858748436, 0.07724642008543015},
        {0.08945325016975403, 0.0878508985042572, -0.3343936800956726, 0.22188805043697357, 0.02918040007352829, -0.11622065305709839, 0.13891148567199707, 0.11343614012002945, 0.004146344494074583, -0.2058168202638626, 0.13373133540153503, -0.04526849463582039, 0.15071268379688263},
        {0.011277466081082821, 0.15457768738269806, 0.3522428274154663, -0.0021387271117419004, 0.08112780749797821, -0.0649770125746727, -0.23773188889026642, 0.3145473897457123, -0.056249428540468216, 0.30623719096183777, 0.29062360525131226, 0.017743723466992378, -0.0961134061217308},
        {-0.2795874774456024, 0.14483612775802612, -0.29644834995269775, -0.3173191249370575, -0.3480623662471771, -0.17418552935123444, -0.14220233261585236, 0.03250998631119728, 0.24227873980998993, 0.2868981659412384, -0.11303849518299103, 0.3695105016231537, 0.21374352276325226},
        {-0.24100430309772491, 0.03465849161148071, -0.01246631145477295, -0.055117279291152954, 0.12907910346984863, -0.18860048055648804, -0.07719138264656067, 0.1858980655670166, 0.13520973920822144, -0.08134758472442627, 0.08189085125923157, 0.0054943859577178955, -0.09769502282142639},
        {0.2357015162706375, -0.3082718551158905, -0.26067206263542175, -0.003369682701304555, 0.14423906803131104, -0.29610568284988403, 0.40231651067733765, -0.021807024255394936, 0.12111889570951462, -0.09727291017770767, -0.04184453934431076, 0.11439186334609985, 0.27263644337654114},
        {0.09005718678236008, 0.12142553180456161, 0.09309370070695877, -0.006446582265198231, -0.17473404109477997, -0.09553925693035126, -0.035917818546295166, -0.3467402756214142, 0.0077574653550982475, 0.08757397532463074, -0.10526729375123978, -0.5018775463104248, 0.16564883291721344},
        {0.0857909619808197, -0.22510536015033722, -0.10960063338279724, 0.13411401212215424, -0.2482769936323166, -0.1745775192975998, 0.048947785049676895, -0.21070018410682678, 0.11550881713628769, -0.17686282098293304, 0.17016659677028656, -0.20143350958824158, -0.09569552540779114},
        {-0.21106696128845215, 0.1845826357603073, -0.1336183398962021, -0.20151486992835999, 0.3160472810268402, 0.05135805159807205, -0.23925019800662994, 0.3123648166656494, 0.11950531601905823, 0.20708386600017548, -0.12720099091529846, 0.5394529700279236, -0.2701716721057892},
        {0.24076229333877563, -0.048077382147312164, 0.019108973443508148, 0.0456293448805809, -0.10204212367534637, -0.09394996613264084, -0.09844540804624557, 0.14413264393806458, 0.11523236334323883, -0.15636928379535675, 0.15668772161006927, 0.3028734624385834, -0.39254286885261536},
        {0.25438687205314636, -0.1207493245601654, -0.1215147003531456, -0.0792984738945961, 0.0779842808842659, 0.2546539604663849, 0.01965235359966755, 0.22072717547416687, 0.0872950479388237, -0.06678719818592072, -0.21742190420627594, -0.21828976273536682, -0.2024996429681778},
        {0.09794247150421143, 0.001797020435333252, -0.12012186646461487, -0.2605385184288025, 0.006650030612945557, -0.2775697410106659, -0.12525027990341187, -0.25534409284591675, -0.13802707195281982, -0.14594319462776184, -0.10874049365520477, -0.14186067879199982, -0.23241764307022095},
        {0.21378418803215027, 0.4350476562976837, -0.1399884670972824, 0.14064951241016388, -0.17682652175426483, 0.046833157539367676, 0.044287294149398804, 0.05140259116888046, -0.28567346930503845, 0.10871921479701996, -0.23691758513450623, -0.332646906375885, 0.057791393250226974},
        {-0.24404092133045197, 0.29350709915161133, -0.2695581912994385, 0.1643470674753189, 0.06287238001823425, -0.13027645647525787, 0.30569857358932495, 0.0923115611076355, -0.1253168135881424, 0.17577508091926575, 0.0360080786049366, -0.4089112877845764, 0.29292958974838257},
        {-0.21706169843673706, 0.24591311812400818, -0.42701488733291626, 0.09676416218280792, 0.2600800395011902, 0.10258068889379501, 0.30608758330345154, -0.09883393347263336, -0.009290271438658237, -0.3085261881351471, 0.1275903880596161, 0.12181178480386734, 0.20244480669498444},
};

uint64_t DSY_QSPI_BSS qspi_buffer[SHAPE_L_1][IN_SHAPE];


int main(void)
{
    hw.Configure();
    hw.Init();

    size_t size = sizeof(weights_l1);
    /** Grab physical address from pointer */
    size_t address = (size_t)qspi_buffer;

    hw.qspi.Erase(address, address + size);
    hw.qspi.Write(address, size, (uint8_t*)weights_l1);


    while(1)
    {
        hw.SetLed(true);
        System::Delay(500);
        hw.SetLed(false);
        System::Delay(500);
    }
}